<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Movie Catalog</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸŽ¬</text></svg>">
<script src="https://unpkg.com/@zxing/library@latest/umd/index.min.js"></script>
</head>
<body>
  <div class="container">
    <!-- Header Section -->
    <header class="app-header">
      <div class="header-left">
        <h1>Movie Catalog</h1>
      </div>
      <div class="header-center">
        <div class="spreadsheet-selection">
          <div class="spreadsheet-info">
            <span id="spreadsheet-status">No spreadsheet selected</span>
            <button id="select-spreadsheet-btn" class="select-btn" onclick="selectSpreadsheet()">
              Select Spreadsheet
            </button>
          </div>
        </div>
      </div>
      <div class="header-right">
        <div class="stats-summary">
          <span id="total-movies">0 movies</span>
          <span class="separator">â€¢</span>
          <span id="total-formats">0 formats</span>
          <span class="separator">â€¢</span>
          <span id="total-genres">0 genres</span>
          <span class="separator">â€¢</span>
          <span id="total-years">0 years</span>
        </div>
      </div>
    </header>

    <!-- Control Panel / Toolbar -->
    <div class="control-panel">
      <div class="control-left">
        <div class="view-options">
          <button id="card-view-btn" class="view-btn active" onclick="switchToCardView()">
            Card View
          </button>
          <button id="list-view-btn" class="view-btn" onclick="switchToListView()">
            List View
          </button>
        </div>
        <div class="sorting-options">
          <label for="sort-field">Sort by:</label>
          <select id="sort-field" class="sort-select" onchange="updateSorting()">
            <option value="title">Title</option>
            <option value="year">Year</option>
            <option value="director">Director</option>
            <option value="genre">Genre</option>
            <option value="added">Date Added</option>
            <option value="upc">UPC</option>
          </select>
          <button id="sort-direction" class="sort-direction active" onclick="toggleSortDirection()">
            Ascending
          </button>
        </div>
      </div>
      <div class="control-center">
        <div class="search-section">
          <input type="text" id="search-input" placeholder="Search movies..." onkeyup="filterMovies()">
        </div>
      </div>
      <div class="control-right">
        <div class="add-options">
          <button id="scan-upc-btn" class="add-btn scan-btn" onclick="openScanner()">
            Scan UPC
          </button>
          <button id="manual-add-btn" class="add-btn manual-btn" onclick="showAddMovieForm()">
            Manual Add
          </button>
        </div>
      </div>
    </div>

    <!-- Content Display Area -->
    <div class="content-area">
      <!-- Movie List (Card View) -->
      <div id="movieList" class="movie-list card-view">
        <div class="empty-state">
          <h3>Start Building Your Collection</h3>
          <p>Add movies manually or use the barcode scanner to get started!</p>
        </div>
      </div>
      
      <!-- Movie Table (List View) -->
      <div id="movieTable" class="movie-table list-view" style="display: none;">
        <table class="movie-table-content">
          <thead>
            <tr>
              <th>Cover</th>
              <th>Title</th>
              <th>Year</th>
              <th>Director</th>
              <th>Genre</th>
              <th>Runtime</th>
              <th>Formats</th>
              <th>UPC</th>
              <th>Added</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="movie-table-body">
            <tr>
              <td colspan="10" class="empty-state">
                <div>
                  <h3>No Data Yet</h3>
                  <p>Start by adding your first movie!</p>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Add Movie Modal -->
  <div id="addMovieModal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Add New Movie</h2>
        <button class="close-btn" onclick="hideAddMovieForm()">&times;</button>
      </div>
      <form id="movieForm" onsubmit="handleAddMovie(event)">
        <div class="form-group">
          <label for="title">Title *</label>
          <input type="text" id="title" name="title" required>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="year">Year</label>
            <input type="number" id="year" name="year" min="1900" max="2030">
          </div>
          <div class="form-group">
            <label for="director">Director</label>
            <input type="text" id="director" name="director">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="genre">Genre</label>
            <input type="text" id="genre" name="genre">
          </div>
          <div class="form-group">
            <label for="runtime">Runtime (minutes)</label>
            <input type="number" id="runtime" name="runtime" min="1">
          </div>
        </div>
        <div class="form-group">
          <label for="upc">UPC</label>
          <input type="text" id="upc" name="upc">
        </div>
        <div class="form-group">
          <label>Formats</label>
          <div class="format-options">
            <div><label><input type="checkbox" name="formats" value="DVD"><span>DVD</span></label></div>
            <div><label><input type="checkbox" name="formats" value="Blu-ray"><span>Blu-ray</span></div>
            <div><label><input type="checkbox" name="formats" value="4K"><span>4K</span></label></div>
            <div><label><input type="checkbox" name="formats" value="Digital"><span>Digital</span></label></div>
            <div><label><input type="checkbox" name="formats" value="VHS"><span>VHS</span></label></div>
          </div>
        </div>
        <div class="form-actions">
          <button type="submit" class="submit-btn">Add Movie</button>
          <button type="button" class="cancel-btn" onclick="hideAddMovieForm()">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Scanner Modal -->
  <div id="scanner-modal" class="scanner-modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Barcode Scanner</h3>
        <button class="close-btn" onclick="closeScannerModal()">&times;</button>
      </div>
      <div class="scanner-container">
        <div class="camera-container">
          <video id="scanner-video" autoplay muted></video>
          <div class="scanner-overlay">
            <div class="scanner-line"></div>
          </div>
        </div>
        <div class="scanner-controls">
          <div class="camera-selection">
            <label for="camera-select">Camera:</label>
            <select id="camera-select"></select>
          </div>
          <button id="start-scanner-btn" onclick="startScanner()">Start Scanner</button>
          <button id="stop-scanner-btn" onclick="stopScanner()" style="display: none;">Stop Scanner</button>
          <button id="debug-camera" onclick="debugCamera()">Debug Camera</button>
          <button id="test-camera" onclick="testCamera()">Test Camera</button>
        </div>
        <div class="manual-upc">
          <label for="manual-upc-input">Or enter UPC manually:</label>
          <div class="manual-input-group">
            <input type="text" id="manual-upc-input" placeholder="Enter UPC code">
            <button type="button" onclick="handleManualUPC()">Lookup</button>
          </div>
        </div>
        <div id="scanner-result"></div>
      </div>
    </div>
  </div>

  <!-- Import/Export Section -->
  <div id="importExportSection" class="import-export-section" style="display: none;">
    <h3>Import/Export Options</h3>
    <div class="import-export-controls">
      <div class="import-section">
        <h4>Import</h4>
        <div class="import-options">
          <input type="file" id="csvFile" accept=".csv" onchange="handleFileUpload(event, 'csv')">
          <button onclick="importFromCSV()">Import CSV</button>
          <input type="file" id="jsonFile" accept=".json" onchange="handleFileUpload(event, 'json')">
          <button onclick="importFromJSON()">Import JSON</button>
        </div>
      </div>
      <div class="export-section">
        <h4>Export</h4>
        <div class="import-options">
          <button onclick="exportToCSV()">Export to CSV</button>
          <button onclick="exportToJSON()">Export to JSON</button>
        </div>
      </div>
    </div>
  </div>

  <script src="js/data-manager.js"></script>
  <script src="js/spreadsheet-manager.js"></script>
  <script src="js/import-export.js"></script>
  <script src="js/scanner-new.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
